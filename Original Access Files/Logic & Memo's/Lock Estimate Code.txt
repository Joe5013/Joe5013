=================================================
Use for UNBOUND text box, combo box, list box, checkbox
=================================================
'varUndo is used by unbound boxes to undo if estimate is locked
Private varUndo As Variant

Private Sub Combo8_GotFocus()
    'Store the undo value
    varUndo = Screen.ActiveControl.Value
End Sub

Private Sub Combo8_AfterUpdate()
    Dim strUser As String, ctl1 As Control
    Set ctl1 = Screen.ActiveControl
    '--- Check to see if Estimate is Locked ---
    If EstimateIsLocked(strUser) Then
        MsgBox "Estimate is Locked by " & strUser
        ctl1.Value = varUndo
        Exit Sub
    End If

    'The rest of After Update....
End Sub

=================================================
Use for BOUND text box, combo box, list box, check box
=================================================

Private Sub ElineDescription_BeforeUpdate(Cancel As Integer)
    Dim strUser As String, ctl1 As Control
    '--- Check to see if Estimate is Locked ---
    Set ctl1 = Screen.ActiveControl
    If EstimateIsLocked(strUser) Then
        MsgBox "Estimate is Locked by " & strUser
        Cancel = True
        ctl1.Undo
        Exit Sub
    End If
    
    'More Code...
End Sub




    Exit Sub
'ALSO, for text boxes that also have a KeyDown event which lets arrow keys move focus, the keydown event needs error checking as follows
Errorhandler:
    Select Case Err.Number
        Case 2001, 2105, 2110, 3072, 3021, 2501, 2101, 2113
            'these errors are generated by the BeforeUpdate event when it cancels an entry and possibly other similar situations
                'cancels an update caused by the arrow down event which advances to the next record when instead you need to stay on the same record.
                'also similar situation when canceling when Estimate is Locked
            '2001 you canceled previous operation
            '2110 can not move focus to Text20
            '2501 RunCommand action was canceled
            '2101 the Setting you entered isn't valid for this property
            '2113 the value you entered isn't valid for this field (like entering text in a line no field
            Exit Sub
        Case Else
            MsgBox "Error number " & Err.Number & " : " & Err.Description, vbCritical, "Error"
            fSkipGotFocus = False
            Application.Echo True
    End Select
    Resume Cleanup

=================================================
Use for BUTTON
=================================================

Private Sub Command59_Click()
    dim strUser As String
    '--- Check to see if Estimate is Locked ---
    If EstimateIsLocked(strUser) Then 'EstimateIsLocked(strUser, EstimateID)
        MsgBox "Estimate is Locked by " & strUser
        Exit Sub
    End If